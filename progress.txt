## Progress Tracker

### Phase 1: Type Safety & Foundations
- [x] Task 1: Branded ID types
- [x] Task 2: Shared API response types
- [x] Task 3: Replace t.Any() message validation
- [x] Task 4: Shared tool output types
- [x] Task 5: Discriminated union for asset status (included in Task 2)

### Phase 2: Critical Fixes
- [x] Task 6: Fix convertToModelMessages async (already awaited in stream.ts)
- [x] Task 7: Wire assetId/collectionId into chat context
- [x] Task 8: Resource authorization
- [x] Task 9: Handle reasoning tokens (Option A: collapsible Thinking section in message.tsx + sendReasoning: true)
- [x] Task 10: Input guardrails (gpt-4o-mini pre-check in guardrails.ts, static refusal via createUIMessageStream)

### Phase 3: Data & Persistence
- [x] Task 11: Normalize message persistence (qa_message_parts table, saveMessages/getMessages in ChatService, migration 0002)
- [x] Task 12: Embedding model versioning (added model + dimensions columns to embeddings table, constants in provider.ts, pipeline stores model info, retrieval warns on mismatch, migration 0003). Also fixed branded type mismatches in retrieval.ts, tools.ts, stream.ts, types.ts, and chat/index.ts
- [x] Task 13: Pipeline error handling & retry (withRetry utility with exponential backoff + jitter, 3 retries per stage, attempts/lastError tracked in DB, POST /api/assets/:id/retry endpoint, retry button in asset-card.tsx). Also fixed branded type system: switched from unique symbol to phantom __brand pattern, exported brand from helpers.ts, updated all services + routes to use branded ID types with casts at route boundaries.

### Phase 4: UX Improvements
- [x] Task 14: Asset detail view (new /asset/[id] route with DashboardLayout, AssetDetail client component fetches asset+transcript+segments via Eden, TranscriptViewer shows timestamped segments with speaker labels, ChatPanel reused as side panel, status polling while processing, back nav to library. Asset cards now link to detail page when ready.)
- [x] Task 15: Collection management UI (library tab Assets/Collections toggle, collection-list.tsx + collection-card.tsx with edit/delete dialogs, create-collection-dialog.tsx, add-to-collection-dialog.tsx on asset cards via FolderPlus icon, /collection/[id] detail page with member asset list + remove items + scoped Q&A ChatPanel via collectionId, add-asset-to-collection-dialog.tsx in detail view)
- [x] Task 16: Streaming progress indicators (enhanced existing SSE system: added progress field to AssetStatusEvent, emitAssetProgress helper for sub-stage progress, pipeline emits per-segment embedding progress, AssetCard uses real SSE progress mapped to overall % via stage ranges, useAssetEvents hook has auto-reconnection with exponential backoff, AssetList tracks per-asset progress map, AssetDetail shows live progress messages)
- [ ] Task 17: Search and filter

### Phase 5: Sharing & Access Control
- [ ] Task 18: Share link schema & API
- [ ] Task 19: Share link UI
- [ ] Task 20: Rate-limited shared Q&A

### Phase 6: Production Hardening
- [ ] Task 21: Request logging middleware
- [ ] Task 22: Rate limiting
- [ ] Task 23: Health checks & graceful shutdown
- [ ] Task 24: Error boundaries & offline handling
